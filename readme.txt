# 基于页面跳转关系的网页归档系统（文件夹体现层级）

## 1. 项目目标

实现一个网页归档工具，用户输入一个起始 URL 后，系统能够自动：

* 爬取页面及其内部跳转链接页面
* 将每个页面转换为 PDF 并保存本地
* 下载页面内可获取的附件资源
* 构建页面跳转关系索引
* **通过文件夹父子结构体现页面之间的跳转层级**
---
## 2. 核心功能模块

---

## ① 页面递归爬取（基于入口 URL）

### 功能描述

用户提供一个起始页面 URL，系统需要：

1. 请求并解析该页面 HTML
2. 提取页面中所有可跳转链接（子页面 URL）
3. 对这些子页面继续递归爬取
4. 每个页面必须生成 PDF 并保存
5. 下载页面内可直接获取的附件文件
6. 保存当前页面的跳转关系信息

---

## ② 搜索模式爬取（基于站内搜索结果）

### 功能描述

支持另一种爬取方式：

1. 根据用户输入 URL，进入站内搜索结果页
2. 遍历搜索结果中的页面链接
3. 对每个页面抓取 HTML → 转 PDF
4. 下载页面附件资源
5. 保存页面跳转关系（同样用文件夹体现层级）

适用于：

* 页面数量大，不适合全站递归
* 用户只希望归档搜索相关页面

---

## 3. Node 数据结构设计（不递归嵌套）

每个页面对应一个 Node 文件，用于记录页面信息：

```js
Node = {
  page_url: "https://xxx.com/page-A",
  pdf: "page-A.pdf",
  files: ["附件1.zip", "附件2.docx"],
  children: [
    "https://xxx.com/page-B",
    "https://xxx.com/page-C"
  ]
}
```

### 字段说明

| 字段       | 含义                        |
| -------- | ------------------------- |
| page_url | 当前页面 URL                  |
| pdf      | 当前页面生成的 PDF 文件            |
| files    | 当前页面可下载附件资源               |
| children | 当前页面跳转到的子页面 URL 列表（仅 URL） |

📌注意：

* `children` 不保存 Node 对象
* 仅作为链接关系索引
* 子页面的层级由文件夹结构体现

---

## 4. 页面关系存储方式：文件夹父子结构体现跳转关系

### 存储原则

* 每个页面对应一个文件夹
* 子页面文件夹嵌套在父页面文件夹内
* 文件夹层级即页面跳转层级
* Node.json 只记录 URL，不需要递归结构

---

### 示例目录结构

```
root/
 ├── page-A/
 │    ├── page-A.pdf
 │    ├── Node.json
 │    ├── 附件.zip
 │    ├── page-B/
 │    │     ├── page-B.pdf
 │    │     ├── Node.json
 │    ├── page-C/
 │          ├── page-C.pdf
 │          ├── Node.json
```

### 说明

* page-A 的 Node.json 中 children 包含 B、C 的 URL
* page-B、page-C 的层级关系通过文件夹嵌套自然表达
* 不需要 Node 对象递归引用

---

## 5. 每个页面归档内容

每个页面文件夹内必须包含：

✅ 页面 PDF
✅ Node.json（页面索引信息）
✅ 页面可下载附件资源
✅ 子页面文件夹（递归生成）

---

## 6. 最终交付结果

系统输出：

1. 一个以入口 URL 为根的页面跳转归档目录
2. 每个页面生成：

   * PDF 文件
   * 附件资源
   * Node.json（子页面 URL 列表）
3. 页面层级关系通过文件夹结构表达
4. 支持两种抓取模式：

   * 页面递归模式
   * 搜索结果模式

---

## 7. 关键设计总结

* Node 不递归嵌套
* children 只保存 URL
* 页面跳转层级由文件夹结构表达
* 文件夹结构就是最终树结构

---

如果你愿意，我下一步可以继续帮你补：

✅ Node.json 最终标准格式模板
✅ URL 去重和循环跳转处理方案
✅ 文件夹命名规则（URL编码/slug）
✅ 技术实现拆分（爬虫 + PDF + 下载器）

你希望这个需求最终输出成「开发任务拆解版」还是「正式PRD文档版」？
